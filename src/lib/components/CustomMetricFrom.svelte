<script lang="ts">
	import { metricUnits } from '$lib/json/metricUnits.json';
	import { customMetrics } from '$lib/stores/customMetricStore.svelte';

	let { index }: { index: any } = $props();

	let fromFields = $state({ key: customMetrics?.attributes?.[index]?.key ||  '', value: customMetrics?.attributes?.[index]?.value ||  '', unit: customMetrics?.attributes?.[index]?.unit ||  '' });
</script>

<div class="relative grid grid-cols-1 gap-4 pr-[50px] md:grid-cols-2 lg:grid-cols-3">
	<label class="floating-label" oninput={() => customMetrics.updateIndex(index, fromFields)}>
		<span>Key</span>
		<input name="key" type="text" placeholder="Key" class="input w-full" required />
	</label>

	<label class="floating-label">
		<span>Unit</span>

		<select
			class="select w-full"
			name="unit"
			required
			onchange={() => customMetrics.updateIndex(index, fromFields)}
		>
			<option value="">Select</option>
			{#each metricUnits as u}
				<option value={u}>{u}</option>
			{/each}
		</select>
	</label>

	<label class="floating-label" oninput={() => customMetrics.updateIndex(index, fromFields)}>
		<span>Value</span>
		<input name="value" type="text" placeholder="Value" class="input w-full" required />
	</label>

	{#if index != 0}
		<button
			aria-label="delete"
			type="button"
			class=" btn absolute right-0 btn-circle btn-error"
			onclick={() => {
				customMetrics.delete(index);
			}}
		>
			<svg
				xmlns:xlink="http://www.w3.org/1999/xlink"
				xmlns="http://www.w3.org/2000/svg"
				version="1.1"
				width="25px"
				height="26px"
			>
				<g transform="matrix(1 0 0 1 -58 -57 )">
					<path
						d="M 8.931107954545455 21.514322916666668  C 9.037642045454545 21.412760416666668  9.090909090909092 21.28298611111111  9 21.125  L 9 9.208333333333332  C 9.090909090909092 9.050347222222223  9.037642045454545 8.920572916666668  8.931107954545455 8.819010416666668  C 8.824573863636363 8.717447916666668  8.68844696969697 8.666666666666668  8.522727272727272 8.666666666666668  L 7.386363636363637 8.666666666666668  C 7.22064393939394 8.666666666666668  7.084517045454547 8.717447916666668  6.977982954545454 8.819010416666668  C 6.871448863636363 8.920572916666668  6.8181818181818175 9.050347222222223  7 9.208333333333332  L 7 21.125  C 6.8181818181818175 21.28298611111111  6.871448863636363 21.412760416666668  6.977982954545454 21.514322916666668  C 7.084517045454547 21.615885416666668  7.22064393939394 21.666666666666668  7.386363636363637 21.666666666666668  L 8.522727272727272 21.666666666666668  C 8.68844696969697 21.666666666666668  8.824573863636363 21.615885416666668  8.931107954545455 21.514322916666668  Z M 13.4765625 21.514322916666668  C 13.583096590909092 21.412760416666668  13.636363636363635 21.28298611111111  13.636363636363635 21.125  L 13.636363636363635 9.208333333333332  C 13.636363636363635 9.050347222222223  13.583096590909092 8.920572916666668  13.4765625 8.819010416666668  C 13.370028409090908 8.717447916666668  13.233901515151517 8.666666666666668  13.068181818181818 8.666666666666668  L 11.931818181818182 8.666666666666668  C 11.766098484848486 8.666666666666668  11.629971590909092 8.717447916666668  11.5234375 8.819010416666668  C 11.416903409090908 8.920572916666668  11.363636363636363 9.050347222222223  11.363636363636363 9.208333333333332  L 11.363636363636363 21.125  C 11.363636363636363 21.28298611111111  11.416903409090908 21.412760416666668  11.5234375 21.514322916666668  C 11.629971590909092 21.615885416666668  11.766098484848486 21.666666666666668  11.931818181818182 21.666666666666668  L 13.068181818181818 21.666666666666668  C 13.233901515151517 21.666666666666668  13.370028409090908 21.615885416666668  13.4765625 21.514322916666668  Z M 18.022017045454543 21.514322916666668  C 18.128551136363637 21.412760416666668  18.181818181818183 21.28298611111111  18 21.125  L 18 9.208333333333332  C 18.181818181818183 9.050347222222223  18.128551136363637 8.920572916666668  18.022017045454543 8.819010416666668  C 17.915482954545457 8.717447916666668  17.779356060606062 8.666666666666668  17.613636363636363 8.666666666666668  L 16.477272727272727 8.666666666666668  C 16.31155303030303 8.666666666666668  16.175426136363637 8.717447916666668  16.068892045454543 8.819010416666668  C 15.962357954545455 8.920572916666668  15.909090909090908 9.050347222222223  16 9.208333333333332  L 16 21.125  C 15.909090909090908 21.28298611111111  15.962357954545455 21.412760416666668  16.068892045454543 21.514322916666668  C 16.175426136363637 21.615885416666668  16.31155303030303 21.666666666666668  16.477272727272727 21.666666666666668  L 17.613636363636363 21.666666666666668  C 17.779356060606062 21.666666666666668  17.915482954545457 21.615885416666668  18.022017045454543 21.514322916666668  Z M 9.392755681818182 2.352864583333332  L 8.522727272727272 4.333333333333332  L 16.477272727272727 4.333333333333332  L 15.625 2.352864583333332  C 15.542140151515154 2.251302083333332  15.441524621212121 2.18923611111111  15.323153409090908 2.166666666666668  L 9.694602272727272 2.166666666666668  C 9.57623106060606 2.18923611111111  9.475615530303031 2.251302083333332  9.392755681818182 2.352864583333332  Z M 24.840198863636363 4.485677083333332  C 24.946732954545457 4.587239583333332  25 4.7170138888888875  25 4.875  L 25 5.958333333333332  C 25 6.116319444444442  24.946732954545457 6.24609375  24.840198863636363 6.34765625  C 24.733664772727273 6.44921875  24.597537878787882 6.5  24.431818181818183 6.5  L 22.727272727272727 6.5  L 22.727272727272727 22.546875  C 22.727272727272727 23.483506944444443  22.449100378787882 24.29318576388889  21.892755681818183 24.975911458333332  C 21.336410984848484 25.65863715277778  20.667613636363637 26  19.886363636363637 26  L 5.113636363636364 26  C 4.332386363636364 26  3.663589015151516 25.669921875  3.107244318181818 25.009765625  C 2.5508996212121215 24.349609375  2.272727272727273 23.55121527777778  2.272727272727273 22.614583333333332  L 2.272727272727273 6.5  L 0.5681818181818182 6.5  C 0.4024621212121212 6.5  0.2663352272727273 6.44921875  0.15980113636363638 6.34765625  C 0.05326704545454545 6.24609375  0 6.116319444444442  0 5.958333333333332  L 0 4.875  C 0 4.7170138888888875  0.05326704545454545 4.587239583333332  0.15980113636363638 4.485677083333332  C 0.2663352272727273 4.384114583333332  0.4024621212121212 4.333333333333332  0.5681818181818182 4.333333333333332  L 6.0546875 4.333333333333332  L 7.2975852272727275 1.5065104166666676  C 7.475142045454547 1.0889756944444422  7.794744318181819 0.7335069444444422  8.256392045454545 0.44010416666666763  C 8.718039772727273 0.14670138888888729  9.18560606060606 0  9.659090909090908 0  L 15.340909090909092 0  C 15.814393939393941 0  16.281960227272727 0.14670138888888729  16.743607954545457 0.44010416666666763  C 17.205255681818183 0.7335069444444422  17.524857954545457 1.0889756944444422  17.702414772727273 1.5065104166666676  L 18.9453125 4.333333333333332  L 24.431818181818183 4.333333333333332  C 24.597537878787882 4.333333333333332  24.733664772727273 4.384114583333332  24.840198863636363 4.485677083333332  Z "
						fill-rule="nonzero"
						fill="#fff"
						stroke="none"
						transform="matrix(1 0 0 1 58 57 )"
					/>
				</g>
			</svg>
		</button>
	{/if}
</div>
